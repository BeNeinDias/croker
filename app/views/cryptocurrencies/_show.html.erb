
<div class="title">
  <div class="title-icon" style="padding-bottom: 10px;">
    <%= image_tag "#{@cryptocurrency.ticker_code}.png", class: "portfolio-icon" %>
  </div>
  <div class="title-header" style="padding-bottom: 6px;">
    <h2 style="padding-top: 9px; padding-bottom: 9px;"><%= @cryptocurrency.ticker_name %></h2>
  </div>
</div>
<!-- This is where we show the price of the coin -->
<div class="price-wrapper">
  <h3>$<%= number_with_delimiter(@latest_price.round(2), :delimiter => ',') %></h3>
</div>
<!-- Start of the chart  -->
<!-- <div class="chart-wrapper"> -->
  <!-- Render the chart in this div -->
<!-- </div> -->
<div id="chart-container" data-historical-prices="<%= @data.to_json %>" class="chart-wrapper">
</div>
<!-- This div contains the timeframe selectors for the chart [1D, 1W, 1M, 1Y, Since Ever] -->
<div class="timeframe-wrapper">
  <div class="show-balance">
    <% if current_user %>
    <h3>Balance:  <span id="balance" class="balance"><%= humanized_money_with_symbol(current_user.fiat_balance) %></span></h3>
    <% else %>
    <h3> </h3>
    <% end %>
  </div>
  <div class="timeframe-btns">
    <div class="btn-timescale one-day selected">1D</div>
    <div class="btn-timescale one-week">1W</div>
    <div class="btn-timescale one-month">1M</div>
    <div class="btn-timescale one-year">1Y</div>
  </div>
</div>
<!-- <div class="balance-container">
  <div class="show-balance">
    <ul class= "list-inline">
      <%# if current_user %>
      <li><h3>Balance:</h3></li>
      <li class="balance"><%#= humanized_money_with_symbol(current_user.fiat_balance) %></li>
      <%# else %>
      <li><h3>Balance:</h3></li>
      <li class="balance">$ --.--</li>
      <%# end %>
    </ul>
  </div>
</div> -->
<!-- Beggining of the BUY/SELL div -->
<div class="buy-sell-container">
  <div class="buy-sell-tabs">
    <div id="buy-trade" class="buy-tab tab-selected text-center">
      <h3>BUY</h3>
    </div>
    <div id="sell-trade" class="sell-tab text-center">
      <h3>SELL</h3>
    </div>
  </div>
  <div class="">
    <% if current_user %>
      <%= hidden_field_tag :user_fiat_balance, current_user.fiat_balance, id:"user_fiat_balance" %>
    <% end %>
    <div class="buy-window">
      <%= form_for Trade.new, html: { autocomplete: "off" }, url: cryptocurrency_trades_path(@cryptocurrency), class: 'buy-input-container' do |f| %>
        <div class="inputs-wrapper">
          <div id="buy-crypto-max" class="btn-max btn-max-left">
            <div>M</div>
            <div>A</div>
            <div>X</div>
          </div>
          <%= f.text_field :cryptocurrency_amount, class: 'crypto-search-input form-control text-right', id: 'tradeValueCryptoBuy', placeholder: "#{@cryptocurrency.ticker_code}" %>
          <i class="material-icons exchange-arrow">compare_arrows</i>
          <%= f.text_field :fiat_amount, class: 'crypto-search-input form-control text-right', id: 'tradeValueFiatBuy', placeholder: 'USD' %>
          <div id="buy-fiat-max" class="btn-max btn-max-right">
            <div>M</div>
            <div>A</div>
            <div>X</div>
          </div>
        </div>
        <div class="fund-warning">
          <div class="crypto-warning">
            <p class="crypto-trade-warning-message trade-warning-message"></p>
          </div>
          <div class="fiat-warning">
            <p class="fiat-trade-warning-message trade-warning-message"></p>
          </div>
        </div>
        <div class="buy-sell-button text-center">
          <%= f.hidden_field :transaction_type, value: 'buy' %>
          <%= f.submit 'BUY',:name=>"transaction_type", id: 'buy-trade-btn', class: 'buy-trade-btn trade-btn btn btn-success sweet-alert-demo' %>
        </div>
      <%= f.hidden_field :fiat_price_cents, value: @latest_price, id:"latest_price" %>
      <% end %>
    </div>


    <div class="buy-input-container sell-window hidden">
      <% if current_user %>
        <% if current_user.has_portfolios? && current_user.portfolios.where(cryptocurrency_id: @cryptocurrency).any? %>
          <%= hidden_field_tag :crypto_amount_held, current_user.portfolios.where(cryptocurrency_id: @cryptocurrency).first.crypto_amount_held , class: "user_crypto_balance" %>
          <% else %>
          <%= hidden_field_tag :crypto_amount_held, '0' , class: "user_crypto_balance" %>
        <% end %>
      <% end %>
      <%= form_for :trade, html: { autocomplete: "off" }, url: cryptocurrency_trades_path(@cryptocurrency), class: 'buy-input-container' do |f| %>
        <div class="inputs-wrapper">
          <%= f.text_field :cryptocurrency_amount, class: 'crypto-search-input form-control text-right', id: 'tradeValueCryptoSell', placeholder: "20000 #{@cryptocurrency.ticker_code}" %>
          <i class="fas fa-exchange-alt"></i>
          <%= f.text_field :fiat_amount, class: 'crypto-search-input form-control text-right', id: 'tradeValueFiatSell', placeholder: '2000 USD'  %>
        </div>
        <div class="buy-sell-button text-center">
          <%= f.hidden_field :transaction_type, value: 'sell' %>
          <%= f.submit 'SELL', class: 'btn btn-success' %>
        </div>
        <%= f.hidden_field :fiat_price_cents, value: @latest_price %>
      <% end %>
    </div>
  </div>
</div>

